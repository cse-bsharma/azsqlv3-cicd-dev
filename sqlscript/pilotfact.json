{
	"name": "pilotfact",
	"properties": {
		"content": {
			"query": "--create schema staging;\n\n/*CREATE TABLE [dbo].[FactInternetSales]\n(\n\t[ProductKey] [int] NOT NULL,\n\t[OrderDateKey] [int] NOT NULL,\n\t[DueDateKey] [int] NOT NULL,\n\t[ShipDateKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[PromotionKey] [int] NOT NULL,\n\t[CurrencyKey] [int] NOT NULL,\n\t[SalesTerritoryKey] [int] NOT NULL,\n\t[SalesOrderNumber] [nvarchar](20) NOT NULL,\n\t[SalesOrderLineNumber] [tinyint] NOT NULL,\n\t[RevisionNumber] [tinyint] NOT NULL,\n\t[OrderQuantity] [smallint] NOT NULL,\n\t[UnitPrice] [money] NOT NULL,\n\t[ExtendedAmount] [money] NOT NULL,\n\t[UnitPriceDiscountPct] [float] NOT NULL,\n\t[DiscountAmount] [float] NOT NULL,\n\t[ProductStandardCost] [money] NOT NULL,\n\t[TotalProductCost] [money] NOT NULL,\n\t[SalesAmount] [money] NOT NULL,\n\t[TaxAmt] [money] NOT NULL,\n\t[Freight] [money] NOT NULL,\n\t[CarrierTrackingNumber] [nvarchar](25) NULL,\n\t[CustomerPONumber] [nvarchar](25) NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [ProductKey] ),\n\tHEAP\n) \n*/\n\nCREATE TABLE [staging].[FactInternetSales]\n(\n\t[ProductKey] [int] NOT NULL,\n\t[OrderDateKey] [int] NOT NULL,\n\t[DueDateKey] [int] NOT NULL,\n\t[ShipDateKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[PromotionKey] [int] NOT NULL,\n\t[CurrencyKey] [int] NOT NULL,\n\t[SalesTerritoryKey] [int] NOT NULL,\n\t[SalesOrderNumber] [nvarchar](20) NOT NULL,\n\t[SalesOrderLineNumber] [tinyint] NOT NULL,\n\t[RevisionNumber] [tinyint] NOT NULL,\n\t[OrderQuantity] [smallint] NOT NULL,\n\t[UnitPrice] [money] NOT NULL,\n\t[ExtendedAmount] [money] NOT NULL,\n\t[UnitPriceDiscountPct] [float] NOT NULL,\n\t[DiscountAmount] [float] NOT NULL,\n\t[ProductStandardCost] [money] NOT NULL,\n\t[TotalProductCost] [money] NOT NULL,\n\t[SalesAmount] [money] NOT NULL,\n\t[TaxAmt] [money] NOT NULL,\n\t[Freight] [money] NOT NULL,\n\t[CarrierTrackingNumber] [nvarchar](25) NULL,\n\t[CustomerPONumber] [nvarchar](25) NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [ProductKey] ),\n\tHEAP\n) \n\nselect count(*) from [dbo].[FactInternetSales];\ntruncate table [dbo].[FactInternetSales];\ntruncate table [dbo].[DimProduct];\nCREATE USER [bhassharma@microsoft.com] FROM EXTERNAL PROVIDER;\ngrant control on database::azsqldw to [bhassharma@microsoft.com];\n\n\nCREATE USER [azsqlv3] FROM EXTERNAL PROVIDER;\n\n--Create a SQL user for the workspace MSI in database\nCREATE USER [azsqlv3] FROM EXTERNAL PROVIDER; -- already exist\n\n--Granting permission to the identity\nGRANT CONTROL ON DATABASE::azsqldw TO azsqlv3;\n\n\n\nselect * from sys.dm_pdw_exec_requests order by start_time desc;\n\nselect count(*) from  [staging].[FactInternetSales];\n\n\n\nselect count(*) from staging.fact;\ndrop table staging.fact;\n\n\n\nCREATE TABLE [dbo].[DimProduct]\n(\n\t[ProductKey] [int] NOT NULL,\n\t[ProductAlternateKey] [nvarchar](25) NULL,\n\t[ProductSubcategoryKey] [int] NULL,\n\t[WeightUnitMeasureCode] [nchar](3) NULL,\n\t[SizeUnitMeasureCode] [nchar](3) NULL,\n\t[EnglishProductName] [nvarchar](50) NOT NULL,\n\t[SpanishProductName] [nvarchar](50) NULL,\n\t[FrenchProductName] [nvarchar](50) NULL,\n\t[StandardCost] [money] NULL,\n\t[FinishedGoodsFlag] [bit] NOT NULL,\n\t[Color] [nvarchar](15) NOT NULL,\n\t[SafetyStockLevel] [smallint] NULL,\n\t[ReorderPoint] [smallint] NULL,\n\t[ListPrice] [money] NULL,\n\t[Size] [nvarchar](50) NULL,\n\t[SizeRange] [nvarchar](50) NULL,\n\t[Weight] [float] NULL,\n\t[DaysToManufacture] [int] NULL,\n\t[ProductLine] [nchar](2) NULL,\n\t[DealerPrice] [money] NULL,\n\t[Class] [nchar](2) NULL,\n\t[Style] [nchar](2) NULL,\n\t[ModelName] [nvarchar](50) NULL,\n\t[EnglishDescription] [nvarchar](400) NULL,\n\t[FrenchDescription] [nvarchar](400) NULL,\n\t[ChineseDescription] [nvarchar](400) NULL,\n\t[ArabicDescription] [nvarchar](400) NULL,\n\t[HebrewDescription] [nvarchar](400) NULL,\n\t[ThaiDescription] [nvarchar](400) NULL,\n\t[GermanDescription] [nvarchar](400) NULL,\n\t[JapaneseDescription] [nvarchar](400) NULL,\n\t[TurkishDescription] [nvarchar](400) NULL,\n\t[StartDate] [datetime] NULL,\n\t[EndDate] [datetime] NULL,\n\t[Status] [nvarchar](7) NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [ProductKey] ),\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nCREATE TABLE dbo.test\n(\nname varchar(20),\nlastname varchar(20)\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [name] ),\n\tHEAP\n) \n\n\nselect * from  dbo.test;\ntruncate table dbo.test;\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "azsqldw",
				"poolName": "azsqldw"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}